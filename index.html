<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>Typing Game</title>
  <style>
    body { font-family: sans-serif; background:#f7f9fc; padding:20px; }
    .card { background:#fff; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); padding:20px; max-width:700px; margin:auto; }
    .row { display:flex; gap:10px; margin:10px 0; }
    button { padding:10px 14px; border:0; border-radius:6px; background:#2b8cff; color:#fff; cursor:pointer; }
    button.secondary { background:#777; }
    input { flex:1; padding:8px; font-size:16px; border:1px solid #ccc; border-radius:6px; }
    .result { margin-top:10px; white-space:pre-line; }
  </style>
</head>
<body>
<div class="card" id="app">
  <h2>Typing Game</h2>
  <div id="menu">
    <p>Ch·ªçn b·ªô t·ª´:</p>
    <button onclick="startGame('Danh t·ª´ (n)')">Danh t·ª´</button>
    <button onclick="startGame('ƒê·ªông t·ª´ (v)')">ƒê·ªông t·ª´</button>
    <button onclick="startGame('T√≠nh t·ª´ (adj)')">T√≠nh t·ª´</button>
  </div>
  <div id="game" style="display:none;">
    <div id="prompt" style="font-size:20px; font-weight:bold; margin:10px 0;"></div>
    <div class="row"><input id="inputWord" placeholder="T·ª´ English" /></div>
    <div class="row"><input id="inputSyll" placeholder="S·ªë √¢m ti·∫øt" /></div>
    <div class="row">
      <button onclick="checkWord()">Ki·ªÉm tra</button>
      <button class="secondary" onclick="speakWord()">üîä Ph√°t √¢m</button>
      <button class="secondary" onclick="backMenu()">‚§∫ Quay l·∫°i</button>
    </div>
    <div class="result" id="result"></div>
  </div>
</div>

<script>
const wordSets = {
  "Danh t·ª´ (n)": {
"h√†nh ƒë·ªông  (n)": ["action"],
            "ho·∫°t ƒë·ªông   (n)": ["activity"],
            "l·ªùi khuy√™n  (n)": ["advice"],
            "m·ª•c ti√™u  (n)": ["aim"],
            "thi·∫øt b·ªã , d·ª•ng c·ª•  (n)": ["appliance"],
            "b·∫ßu kh√¥ng kh√≠   (n)": ["atmosphere"],
            "khu v·ª±c   (n)": ["area"],
            "nh·∫≠n th·ª©c   (n)": ["awareness"],
            "chai l·ªç   (n)": ["bottle"],
            "c√°i th√πng   (n)": ["bin"],
            "d·∫•u ch√¢n cacbon   (n)": ["carbon footprint"],
            "l·ªÖ k·ªâ ni·ªám   (n)": ["ceremony"],
            "s·ª± thay ƒë·ªïi   (n)": ["change"],
            "h√≥a ch·∫•t    (n)": ["chemical"],
            "c√¢u l·∫°c b·ªô    (n)": ["club"],
            "t·ªïn h·∫°i thi·ªát h·∫°i   (n)": ["damage"],
            "thi·∫øt b·ªã    (n)": ["device"],
            "s·ª± kh√°c bi·ªát    (n)": ["difference"],
            "ƒëi·ªán    (n)": ["electricity"],
            "s·ª± th·∫£i ra    (n)": ["emission"],
            "nƒÉng l∆∞·ª£ng    (n)": ["energy"],
            "m√¥i tr∆∞·ªùng    (n)": ["environment"],
            "bu·ªïi tri·ªÉn l√£m    (n)": ["exhibition"],
            "v·ª• n·ªï   (n)": ["explosion"],
            "th√πng r√°c   (n)": ["garbage can"],
            "th√≥i quen   (n)": ["habit"],
            "v·∫•n ƒë·ªÅ    (n)": ["issue"],
            "v·∫≠n d·ª•ng    (n)": ["item"],
            "l·ªëi s·ªëng c√°ch s·ªëng   (n)": ["lifestyle"],
            "nguy√™n li·ªáu    (n)": ["material"],
            "ph∆∞∆°ng ph√°p(n)": ["method"],
            "ngu·ªìn t√†i nguy√™n thi√™n nhi√™n   (n)": ["natural resources"],
            "khu x√≥m   (n)": ["neighborhood"],
            "s·ª± √¥ nhi·ªÖm    (n)": ["pollution"],
            "s·∫£n ph·∫©m   (n)": ["product"],
            "ph∆∞∆°ng ti·ªán c√¥ng c·ªông   (n)": ["public transport"],
            "b√≥ng r√¢m   (n)": ["shade"],
            "t√¨nh hu·ªëng  (n)": ["situation"],
            "l·ªùi ƒë·ªÅ ngh·ªã  (n)": ["suggestion"],
            "nhi·ªát ƒë·ªô   (n)": ["temperature"],
            "chai l·ªç   (n)": ["trash", "rubbish", "waste"],
  },
  "ƒê·ªông t·ª´ (v)": {
    "ƒë·∫°t ƒë∆∞·ª£c  (v)": ["achieve"],
           "ƒë·∫°t ƒë∆∞·ª£c  (v)": ["achieve"],
            "tham d·ª± (v)": ["attend"],
            "d·ª±a tr√™n  (v)": ["base on"],
            "c√≥ th·ªÉ (v)": ["be able to"],
            "t·ª± h√†o v·ªÅ (v)": ["be proud of"],
            "ch·ªãu tr√°ch nhi·ªám (v)": ["be responsible for"],
            "d·ªçn d·∫πp (v)": ["clear up"],
            "s∆∞u t·∫ßm (v)": ["collect"],
            "t·∫°o ra (v)": ["crate"],
            "c·∫Øt gi·∫£m (v)": ["cut down on"],
            "khuy·∫øn kh√≠ch (v)": ["encourage"],
            "∆∞·ªõc t√≠nh (v)": ["estimate"],
            "g√¢y h·∫°i  (v)": ["harm"],
            "cait thi·ªán (v)": ["improve"],
            "tham gia (v)": ["join"],
            "d·∫´n ƒë·∫øn (v)": ["lead"],
            "x·∫£ r√°c (v)": ["litter"],
            "ch·ªçn theo (v)": ["adopt"],
            "chia nh·ªè (v)": ["break down"],
            "t·ªï ch·ª©c (v)": ["organize"],
            "nh·∫∑t (v)": ["pick up"],
            "s·∫£n xu·∫•t ra (v)": ["produce"],
            "b·∫£o v·ªá (v)": ["protect"],
            "cung c·∫•p(v)": ["provide"],
            "l√†m gia tƒÉng (v)": ["raise"],
            "t√°i ch·∫ø (v)": ["recycle"],
            "l√†m gi·∫£m (v)": ["reduce"],
            "th√†nh l·∫≠p (v)": ["set up "],
            "T·∫ÆT  (v)": ["turn off"],
            "l·∫µng ph√≠(v)": ["waste"],
            "tham gia (v)": ["take part in"],
  },
  "T√≠nh t·ª´ (adj)": {
    "nguy hi·ªÉm(adj)": ["adngerous"],
            "d∆° b·∫©n(adj)": ["dirty"],
            "th√¢n thi·ªán m√¥i tr∆∞·ªùng(adj)": ["Eco-friendly"],
            "thu·ªôc v·ªÅ ƒëi·ªán(adj)": ["electrical"],
            "thu·ªôc v·ªÅ m√¥i tr∆∞·ªùng(adj)": ["environment"],
            "to√†n c·∫ßu(adj)": ["global"],
            "ƒë·ªôc h·∫°i(adj)": ["harmful"],
            "t·ª± nhi√™n(adj)": ["natural"],
            "h·ªØu c∆°(adj)": ["organic"],
            "c√° nh√¢n(adj)": ["personal"],
            "b·ªã √¥ nhi·ªÖm (adj)": ["polluted"],
            "ch·ªØ qua ch·∫ø bi·∫øn(adj)": ["raw"],
            "c√≥ th·ªÉ l√†m ƒë·∫ßy l·∫°i (adj)": ["refillable"],
            "c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng (adj)": ["reusable"],
            "b·ªÅn v·ªØng(adj)": ["sustainable"],
  }
};

let currentSet = {}, wordList = [], index=0, reviewList=[];

function startGame(cat){
  currentSet = wordSets[cat];
  wordList = Object.keys(currentSet);
  shuffle(wordList);
  index = 0; reviewList = [];
  document.getElementById("menu").style.display="none";
  document.getElementById("game").style.display="block";
  showWord();
}
function backMenu(){
  document.getElementById("menu").style.display="block";
  document.getElementById("game").style.display="none";
}
function showWord(){
  if(index<wordList.length){
    document.getElementById("prompt").innerText=wordList[index];
  } else {
    if(reviewList.length){
      wordList=reviewList; reviewList=[]; shuffle(wordList); index=0;
      document.getElementById("result").innerText="üîÑ √în t·∫≠p l·∫°i t·ª´ sai...";
      setTimeout(showWord,800);
    } else {
      document.getElementById("prompt").innerText="üéâ Ho√†n th√†nh!";
      document.getElementById("result").innerText="";
    }
  }
}
function checkWord(){
  if(index>=wordList.length) return;
  const current = wordList[index];
  const answers = currentSet[current].map(s=>s.toLowerCase());
  const correct = answers[0];
  const userWord=document.getElementById("inputWord").value.trim().toLowerCase();
  const userSyll=document.getElementById("inputSyll").value.trim();
  const correctSyll=String(countSyllables(correct));
  const ipa = "/"+correct+"/"; // fake IPA n·∫øu kh√¥ng g·ªçi API
  let okWord=answers.includes(userWord), okSyll=(userSyll===correctSyll);
  if(okWord && okSyll){
    document.getElementById("result").innerText=`‚úÖ ƒê√∫ng!\nIPA: ${ipa}\n√Çm ti·∫øt: ${correctSyll}`;
  } else {
    document.getElementById("result").innerText=`‚ùå Sai!\nƒê√°p √°n: ${correct}\nIPA: ${ipa}\n√Çm ti·∫øt: ${correctSyll}`;
    if(!reviewList.includes(current)) reviewList.push(current);
  }
  document.getElementById("inputWord").value="";
  document.getElementById("inputSyll").value="";
  index++;
  setTimeout(showWord,300);
}
function countSyllables(word){
  let groups=word.toLowerCase().replace(/\s+/g,'').match(/[aeiouy]+/g);
  return Math.max(1, groups?groups.length:1);
}
function shuffle(arr){for(let i=arr.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}
function speakWord(){
  if(index>=wordList.length) return;
  const current=wordList[index];
  const text=currentSet[current][0];
  let u=new SpeechSynthesisUtterance(text);
  u.lang="en-US"; speechSynthesis.speak(u);
}
</script>
</body>
</html>
